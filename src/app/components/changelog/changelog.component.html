<div class="tw-component-container">
  <div class="w-full">
    <div class="flex justify-between items-center">
      <div
        class="tw-heading mb-1"
        style="animation-duration: 0.4s; animation-fill-mode: forwards">
        {{ 'CHANGELOG.CHANGELOG_TITLE' | translate }}
      </div>
      <button *ngIf="!loading && (permissionService.hasPermission('manage-changelog-entries') | async)"
              class="ml-4 flex items-center justify-center w-12 h-12 text-white bg-green-500 dark:bg-green-700 rounded-full hover:bg-green-700 dark:hover:bg-green-800 shadow-lg transition duration-300 ease-in-out transform hover:scale-105 animate-fadeInLeft"
              (click)="addEntry()"
              title="{{'CHANGELOG.ADD_ENTRY_DESC' | translate}}">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2"
             viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
        </svg>
      </button>
    </div>
    <div class="mb-8 italic text-gray-500 dark:text-dark-mode-text animate-fadeInRight">
      {{ 'CHANGELOG.BUILD_INFO' | translate: {date: date, time: time, hash: build.git.hash} }}
    </div>

    <div class="tw-separation-line">
      <div class="w-full h-full"></div>
    </div>


    <div *ngFor="let entry of changelog"
         [ngClass]="{'animate-pulse' : loading}"
         class="mb-8 transform transition duration-500 ease-in-out hover:scale-102 animate-fade-in">
      <div class="flex flex-row">
        <div class="text-lg font-semibold text-gray-700 dark:text-title-dark-mode-text
        opacity-0 animate-fadeInRight w-[60%]"
             [ngClass]="{'blur-sm' : loading}"
             style="animation-delay: 0.2s; animation-fill-mode: forwards;">
          {{ processTimestamp(entry.timestamp) }} (
          <ng-container *ngIf="entry.version_category !== 'General'">{{ entry.version_category }}
          </ng-container>
          {{ entry.version }})
        </div>
        <div *ngIf="!loading && (permissionService.hasPermission('manage-changelog-entries') | async)"
             class="flex justify-end space-x-6 w-[40%] animate-fadeInLeft">
          <svg
            (click)="editEntry(entry)"
            class="cursor-pointer w-6 h-6 transition-all hover:scale-105"
            viewBox="0 0 877.7142857142857 1024">
            <title>{{ 'CHANGELOG.EDIT_ENTRY_DESC' | translate }}</title>
            <path
              d="M585.143 512c0-80.571-65.714-146.286-146.286-146.286s-146.286 65.714-146.286 146.286 65.714 146.286 146.286 146.286 146.286-65.714 146.286-146.286zM877.714 449.714v126.857c0 8.571-6.857 18.857-16 20.571l-105.714 16c-6.286 18.286-13.143 35.429-22.286 52 19.429 28 40 53.143 61.143 78.857 3.429 4 5.714 9.143 5.714 14.286s-1.714 9.143-5.143 13.143c-13.714 18.286-90.857 102.286-110.286 102.286-5.143 0-10.286-2.286-14.857-5.143l-78.857-61.714c-16.571 8.571-34.286 16-52 21.714-4 34.857-7.429 72-16.571 106.286-2.286 9.143-10.286 16-20.571 16h-126.857c-10.286 0-19.429-7.429-20.571-17.143l-16-105.143c-17.714-5.714-34.857-12.571-51.429-21.143l-80.571 61.143c-4 3.429-9.143 5.143-14.286 5.143s-10.286-2.286-14.286-6.286c-30.286-27.429-70.286-62.857-94.286-96-2.857-4-4-8.571-4-13.143 0-5.143 1.714-9.143 4.571-13.143 19.429-26.286 40.571-51.429 60-78.286-9.714-18.286-17.714-37.143-23.429-56.571l-104.571-15.429c-9.714-1.714-16.571-10.857-16.571-20.571v-126.857c0-8.571 6.857-18.857 15.429-20.571l106.286-16c5.714-18.286 13.143-35.429 22.286-52.571-19.429-27.429-40-53.143-61.143-78.857-3.429-4-5.714-8.571-5.714-13.714s2.286-9.143 5.143-13.143c13.714-18.857 90.857-102.286 110.286-102.286 5.143 0 10.286 2.286 14.857 5.714l78.857 61.143c16.571-8.571 34.286-16 52-21.714 4-34.857 7.429-72 16.571-106.286 2.286-9.143 10.286-16 20.571-16h126.857c10.286 0 19.429 7.429 20.571 17.143l16 105.143c17.714 5.714 34.857 12.571 51.429 21.143l81.143-61.143c3.429-3.429 8.571-5.143 13.714-5.143s10.286 2.286 14.286 5.714c30.286 28 70.286 63.429 94.286 97.143 2.857 3.429 4 8 4 12.571 0 5.143-1.714 9.143-4.571 13.143-19.429 26.286-40.571 51.429-60 78.286 9.714 18.286 17.714 37.143 23.429 56l104.571 16c9.714 1.714 16.571 10.857 16.571 20.571z"
            ></path>
          </svg>
          <svg
            (click)="deleteEntry(entry.id)"
            class="cursor-pointer w-6 h-6 transition-all hover:scale-105"
            viewBox="0 0 804.5714285714286 1024">
            <title>{{ 'CHANGELOG.DELETE_ENTRY_DESC' | translate }}</title>
            <path
              d="M292.571 420.571v329.143c0 10.286-8 18.286-18.286 18.286h-36.571c-10.286 0-18.286-8-18.286-18.286v-329.143c0-10.286 8-18.286 18.286-18.286h36.571c10.286 0 18.286 8 18.286 18.286zM438.857 420.571v329.143c0 10.286-8 18.286-18.286 18.286h-36.571c-10.286 0-18.286-8-18.286-18.286v-329.143c0-10.286 8-18.286 18.286-18.286h36.571c10.286 0 18.286 8 18.286 18.286zM585.143 420.571v329.143c0 10.286-8 18.286-18.286 18.286h-36.571c-10.286 0-18.286-8-18.286-18.286v-329.143c0-10.286 8-18.286 18.286-18.286h36.571c10.286 0 18.286 8 18.286 18.286zM658.286 834.286v-541.714h-512v541.714c0 27.429 15.429 43.429 18.286 43.429h475.429c2.857 0 18.286-16 18.286-43.429zM274.286 219.429h256l-27.429-66.857c-1.714-2.286-6.857-5.714-9.714-6.286h-181.143c-3.429 0.571-8 4-9.714 6.286zM804.571 237.714v36.571c0 10.286-8 18.286-18.286 18.286h-54.857v541.714c0 62.857-41.143 116.571-91.429 116.571h-475.429c-50.286 0-91.429-51.429-91.429-114.286v-544h-54.857c-10.286 0-18.286-8-18.286-18.286v-36.571c0-10.286 8-18.286 18.286-18.286h176.571l40-95.429c11.429-28 45.714-50.857 76-50.857h182.857c30.286 0 64.571 22.857 76 50.857l40 95.429h176.571c10.286 0 18.286 8 18.286 18.286z"
            ></path>
          </svg>
        </div>
      </div>

      <ul class="list-disc list-inside space-y-2 text-gray-600 dark:text-dark-mode-text mt-3">
        <li *ngFor="let change of entry.changes"
            class="bg-white dark:bg-dark-mode-inside p-4 rounded-lg shadow-md opacity-0
          animate-fadeInUp transform hover:bg-gray-100 dark:hover:bg-dark-mode-inside-hover transition duration-300"
            [ngClass]="{'blur-sm' : loading}"
            style="animation-delay: 0.4s; animation-fill-mode: forwards;">
          {{ change }}
        </li>
      </ul>
    </div>
  </div>
</div>
